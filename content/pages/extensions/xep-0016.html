<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0016: Privacy Lists</title><link rel="stylesheet" type="text/css" href="../xmpp.css" /><link href="../prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="../prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="Privacy Lists" /><meta name="DC.Creator" content="Peter Millard" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Description" content="This specification defines an XMPP protocol extension for enabling or disabling communication with other entities on a network. The protocol, which was first standardized in Section 10 of RFC 3921, can be used to block communication with unknown or undesirable entities. Blocking can be based on Jabber Identifier, subscription state, or roster group. The blocked stanzas can be messages, IQs, inbound or outbound presence stanzas, or all stanzas. The protocol also enables an entity to create, modify, or delete its privacy lists, apply different lists to different connected resources, define a default list, and decline the use of any privacy list during a particular communications session." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2007-02-15" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0016" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 - 2014 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0016: Privacy Lists</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This specification defines an XMPP protocol extension for enabling or disabling communication with other entities on a network. The protocol, which was first standardized in Section 10 of RFC 3921, can be used to block communication with unknown or undesirable entities. Blocking can be based on Jabber Identifier, subscription state, or roster group. The blocked stanzas can be messages, IQs, inbound or outbound presence stanzas, or all stanzas. The protocol also enables an entity to create, modify, or delete its privacy lists, apply different lists to different connected resources, define a default list, and decline the use of any privacy list during a particular communications session.</td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Peter Millard, Peter Saint-Andre</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 - 2015 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Draft</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>1.6</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2007-02-15</td></tr></table><hr /><p style="color:green">NOTICE: The protocol defined herein is a <strong>Draft Standard</strong> of the XMPP Standards Foundation. Implementations are encouraged and the protocol is appropriate for deployment in production systems, but some changes to the protocol are possible before it becomes a Final Standard.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#sect-idp704672">Introduction</a><br />2.  <a href="#protocol">Protocol</a><br />   
      2.1.  <a href="#protocol-syntax">Syntax and Semantics</a><br />   
      2.2.  <a href="#protocol-rules">Business Rules</a><br />   
      2.3.  <a href="#protocol-retrieve">Retrieving One's Privacy Lists</a><br />   
      2.4.  <a href="#protocol-active">Managing Active Lists</a><br />   
      2.5.  <a href="#protocol-default">Managing the Default List</a><br />   
      2.6.  <a href="#protocol-edit">Editing a Privacy List</a><br />   
      2.7.  <a href="#protocol-add">Adding a New Privacy List</a><br />   
      2.8.  <a href="#protocol-remove">Removing a Privacy List</a><br />   
      2.9.  <a href="#protocol-message">Blocking Messages</a><br />   
      2.10.  <a href="#protocol-presencein">Blocking Inbound Presence Notifications</a><br />   
      2.11.  <a href="#protocol-presenceout">Blocking Outbound Presence Notifications</a><br />   
      2.12.  <a href="#protocol-iq">Blocking IQ Stanzas</a><br />   
      2.13.  <a href="#protocol-all">Blocking All Communication</a><br />   
      2.14.  <a href="#protocol-error">Blocked Entity Attempts to Communicate with User</a><br />   
      2.15.  <a href="#protocol-heuristics">Higher-Level Heuristics</a><br />3.  <a href="#disco">Discovering Support</a><br />4.  <a href="#impl">Implementation Notes</a><br />5.  <a href="#security">Security Considerations</a><br />6.  <a href="#iana">IANA Considerations</a><br />7.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      7.1.  <a href="#registrar-ns">Protocol Namespaces</a><br />8.  <a href="#schema">XML Schema</a><br />9.  <a href="#authornote">Author Note</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="sect-idp704672" id="sect-idp704672">Introduction</a></h2>
  <p>Almost all types of Instant Messaging (IM) applications have found it necessary to develop some method for a user to block the receipt of messages and packets from other users (the rationale for such blockage depends on the needs of the individual user). This document defines a flexible method for communications blocking.</p>
  <p>Note: The protocol specified herein MAY be used in conjunction with <span class="ref"><a href="http://xmpp.org/extensions/xep-0191.html">Blocking Command (XEP-0191)</a></span>  [<a href="#nt-idp706864">1</a>]; see <span class="ref">XEP-0191</span> for details.</p>
<h2>2.
       <a name="protocol" id="protocol">Protocol</a></h2>
  <p><span class="em">This section has been copied without modification from Section 10 of <span class="ref"><a href="http://tools.ietf.org/html/rfc3921">RFC 3921</a></span>  [<a href="#nt-idp1559216">2</a>], with the exception of the message stanza handling rule in the <a href="#protocol-error">Blocked Entity Attempts to Communicate with User</a> subsection.</span></p>
  <p>Most instant messaging systems have found it necessary to implement some method for users to block communications from particular other users (this is also required by sections 5.1.5, 5.1.15, 5.3.2, and 5.4.10 of <span class="ref"><a href="http://tools.ietf.org/html/rfc2779">RFC 2779</a></span>  [<a href="#nt-idp1562528">3</a>].  In XMPP this is done by managing one's privacy lists using the 'jabber:iq:privacy' namespace.</p>
  <p>Server-side privacy lists enable successful completion of the following use cases:</p>
  <ul>
    <li>Retrieving one's privacy lists.</li>
    <li>Adding, removing, and editing one's privacy lists.</li>
    <li>Setting, changing, or declining active lists.</li>
    <li>Setting, changing, or declining the default list (i.e., the list that is active by default).</li>
    <li>Allowing or blocking messages based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking inbound presence notifications based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking outbound presence notifications based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking IQ stanzas based on JID, group, or subscription type (or globally).</li>
    <li>Allowing or blocking all communications based on JID, group, or subscription type (or globally).</li>
  </ul>
  <p>Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to entities that are subscribed to a user's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
  <div class="indent"><h3>2.1 <a name="protocol-syntax" id="protocol-syntax">Syntax and Semantics</a></h3>
    <p>A user MAY define one or more privacy lists, which are stored by the user's server.  Each &lt;list/&gt; element contains one or more rules in the form of &lt;item/&gt; elements, and each &lt;item/&gt; element uses attributes to define a privacy rule type, a specific value to which the rule applies, the relevant action, and the place of the item in the processing order.</p>
    <p>The syntax is as follows:</p>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;iq&gt;
  &lt;query xmlns='jabber:iq:privacy'&gt;
    &lt;list name='foo'&gt;
      &lt;item
          type='[jid|group|subscription]'
          value='bar'
          action='[allow|deny]'
          order='unsignedInt'&gt;
        [&lt;message/&gt;]
        [&lt;presence-in/&gt;]
        [&lt;presence-out/&gt;]
        [&lt;iq/&gt;]
      &lt;/item&gt;
    &lt;/list&gt;
  &lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>If the type is "jid", then the 'value' attribute MUST contain a valid Jabber ID.  JIDs SHOULD be matched in the following order:</p>
    <ol>
      <li>&lt;user@domain/resource&gt; (only that resource matches)</li>
      <li>&lt;user@domain&gt; (any resource matches)</li>
      <li>&lt;domain/resource&gt; (only that resource matches)</li>
      <li>&lt;domain&gt; (the domain itself matches, as does any user@domain or domain/resource)</li>
    </ol>
    <p>If the type is "group", then the 'value' attribute SHOULD contain the name of a group in the user's roster.  (If a client attempts to update, create, or delete a list item with a group that is not in the user's roster, the server SHOULD return to the client an &lt;item-not-found/&gt; stanza error.)</p>
    <p>If the type is "subscription", then the 'value' attribute MUST be one of "both", "to", "from", or "none" as defined <span class="ref">RFC 6121</span>, where "none" includes entities that are totally unknown to the user and therefore not in the user's roster at all. These values are exact matches, so that "both" means a bidirectional subscription (not "from" or "to" only).</p>
    <p>If no 'type' attribute is included, the rule provides the "fall-through" case.</p>
    <p>The 'action' attribute MUST be included and its value MUST be either "allow" or "deny".  [<a href="#nt-idp1576960">4</a>]</p>
    <p>The 'order' attribute MUST be included and its value MUST be a non-negative integer that is unique among all items in the list.  (If a client attempts to create or update a list with non-unique order values, the server MUST return to the client a &lt;bad-request/&gt; stanza error.)</p>
    <p>The &lt;item/&gt; element MAY contain one or more child elements that enable an entity to specify more granular control over which kinds of stanzas are to be blocked (i.e., rather than blocking all stanzas).  The allowable child elements are:</p>
    <ul>
      <li>&lt;message/&gt; -- blocks incoming message stanzas</li>
      <li>&lt;iq/&gt; -- blocks incoming IQ stanzas</li>
      <li>&lt;presence-in/&gt; -- blocks incoming presence notifications</li>
      <li>&lt;presence-out/&gt; -- blocks outgoing presence notifications  [<a href="#nt-idp1581520">5</a>]</li>
    </ul>
    <p>Within the 'jabber:iq:privacy' namespace, the &lt;query/&gt; child of an IQ stanza of type "set" MUST NOT include more than one child element (i.e., the stanza MUST contain only one &lt;active/&gt; element, one &lt;default/&gt; element, or one &lt;list/&gt; element); if a sending entity violates this rule, the receiving entity MUST return a &lt;bad-request/&gt; stanza error.</p>
    <p>When a client adds or updates a privacy list, the &lt;list/&gt; element SHOULD contain at least one &lt;item/&gt; child element; when a client removes a privacy list, the &lt;list/&gt; element MUST NOT contain any &lt;item/&gt; child elements.</p>
    <p>When a client updates a privacy list, it must include all of the desired items (i.e., not a "delta").</p>
  </div>
  <div class="indent"><h3>2.2 <a name="protocol-rules" id="protocol-rules">Business Rules</a></h3>
    <ol>
      <li><p>If there is an active list set for a session, it affects only the session(s) for which it is activated, and only for the duration of the session(s); the server MUST apply the active list only and MUST NOT apply the default list (i.e., there is no "layering" of lists).</p></li>
      <li><p>The default list applies to the user as a whole, and is processed if there is no active list set for the target session/resource to which a stanza is addressed, or if there are no current sessions for the user.</p></li>
      <li><p>If there is no active list set for a session (or there are no current sessions for the user), and there is no default list, then all stanzas SHOULD BE accepted or appropriately processed by the server on behalf of the user in accordance with the server rules for handling XML stanzas defined in <span class="ref">RFC 6121</span>.</p></li>
      <li><p>Privacy lists MUST be the first delivery rule applied by a server, superseding (1) the routing and delivery rules specified in server rules for handling XML stanzas defined in <span class="ref">RFC 6121</span> and (2) the handling of subscription-related presence stanzas (and corresponding generation of roster pushes) specified in <span class="ref">RFC 6121</span>.</p></li>
      <li><p>The order in which privacy list items are processed by the server is important.  List items MUST be processed in ascending order determined by the integer values of the 'order' attribute for each &lt;item/&gt;.</p></li>
      <li><p>As soon as a stanza is matched against a privacy list rule, the server MUST appropriately handle the stanza in accordance with the rule and cease processing.</p></li>
      <li><p>If no fall-through item is provided in a list, the fall-through action is assumed to be "allow".</p></li>
      <li><p>If a user updates the definition for an active list, subsequent processing based on that active list MUST use the updated definition (for all resources to which that active list currently applies).</p></li>
      <li><p>If a change to the subscription state or roster group of a roster item defined in an active or default list occurs during a user's session, subsequent processing based on that list MUST take into account the changed state or group (for all resources to which that list currently applies).</p></li>
      <li><p>When the definition for a rule is modified, the server MUST send an IQ stanza of type "set" to all connected resources, containing a &lt;query/&gt; element with only one &lt;list/&gt; child element, where the 'name' attribute is set to the name of the modified privacy list.  These "privacy list pushes" adhere to the same semantics as the "roster pushes" used in roster management, except that only the list name itself (not the full list definition or the "delta") is pushed to the connected resources.  It is up to the receiving resource to determine whether to retrieve the modified list definition, although a connected resource SHOULD do so if the list currently applies to it.</p></li>
      <li><p>When a resource attempts to remove a list or specify a new default list while that list applies to a connected resource other than the sending resource, the server MUST return a &lt;conflict/&gt; error to the sending resource and MUST NOT make the requested change.</p></li>
    </ol>
  </div>
  <div class="indent"><h3>2.3 <a name="protocol-retrieve" id="protocol-retrieve">Retrieving One's Privacy Lists</a></h3>
    <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Client requests names of privacy lists from server</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist1'&gt;
&lt;query xmlns='jabber:iq:privacy'/&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Server sends names of privacy lists to client, preceded by active list and default list</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='getlist1' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='private'/&gt;
  &lt;default name='public'/&gt;
  &lt;list name='public'/&gt;
  &lt;list name='private'/&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Client requests a privacy list from server</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Server sends a privacy list to client</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='getlist2' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='1'/&gt;
    &lt;item action='allow' order='2'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Client requests another privacy list from server</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Server sends another privacy list to client</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='getlist3' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'&gt;
    &lt;item type='subscription'
          value='both'
          action='allow'
          order='10'/&gt;
    &lt;item action='deny' order='15'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Client requests yet another privacy list from server</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='get' id='getlist4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Server sends yet another privacy list to client</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='getlist4' to='romeo@example.net/orchard'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='special'&gt;
    &lt;item type='jid'
          value='juliet@example.com'
          action='allow'
          order='6'/&gt;
    &lt;item type='jid'
          value='benvolio@example.org'
          action='allow'
          order='7'/&gt;
    &lt;item type='jid'
          value='mercutio@example.org'
          action='allow'
          order='42'/&gt;
    &lt;item action='deny' order='666'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>In this example, the user has three lists: (1) 'public', which allows communications from everyone except one specific entity (this is the default list); (2) 'private', which allows communications only with contacts who have a bidirectional subscription with the user (this is the active list); and (3) 'special', which allows communications only with three specific entities.</p>
    <p>If the user attempts to retrieve a list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <p class="caption"><a name="example-9" id="example-9"></a>Example 9. Client attempts to retrieve non-existent list</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='getlist5'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p>The user is allowed to retrieve only one list at a time.  If the user attempts to retrieve more than one list in the same request, the server MUST return a &lt;bad request/&gt; stanza error to the user:</p>
    <p class="caption"><a name="example-10" id="example-10"></a>Example 10. Client attempts to retrieve more than one list</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='getlist6'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
  &lt;list name='private'/&gt;
  &lt;list name='special'/&gt;
&lt;/query&gt;
&lt;error type='modify'&gt;
  &lt;bad-request
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>2.4 <a name="protocol-active" id="protocol-active">Managing Active Lists</a></h3>
    <p>In order to set or change the active list currently being applied by the server, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains an empty &lt;active/&gt; child element possessing a 'name' attribute whose value is set to the desired list name.</p>
    <p class="caption"><a name="example-11" id="example-11"></a>Example 11. Client requests change of active list</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='active1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>The server MUST activate and apply the requested list before sending the result back to the client.</p>
    <p class="caption"><a name="example-12" id="example-12"></a>Example 12. Server acknowledges success of active list change</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='active1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p>If the user attempts to set an active list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <p class="caption"><a name="example-13" id="example-13"></a>Example 13. Client attempts to set a non-existent list as active</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='active2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p>In order to decline the use of any active list, the connected resource MUST send an empty &lt;active/&gt; element with no 'name' attribute.</p>
    <p class="caption"><a name="example-14" id="example-14"></a>Example 14. Client declines the use of active lists</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='active3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;active/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-15" id="example-15"></a>Example 15. Server acknowledges success of declining any active list</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='active3' to='romeo@example.net/orchard'/&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>2.5 <a name="protocol-default" id="protocol-default">Managing the Default List</a></h3>
    <p>In order to change its default list (which applies to the user as a whole, not only the sending resource), the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains an empty &lt;default/&gt; child element possessing a 'name' attribute whose value is set to the desired list name.</p>
    <p class="caption"><a name="example-16" id="example-16"></a>Example 16. User requests change of default list</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='special'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-17" id="example-17"></a>Example 17. Server acknowledges success of default list change</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='default1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p>If the user attempts to change which list is the default list but the default list is in use by at least one connected resource other than the sending resource, the server MUST return a &lt;conflict/&gt; stanza error to the sending resource:</p>
    <p class="caption"><a name="example-18" id="example-18"></a>Example 18. Client attempts to change the default list but that list is in use by another resource</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='special'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;conflict
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p>If the user attempts to set a default list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user:</p>
    <p class="caption"><a name="example-19" id="example-19"></a>Example 19. Client attempts to set a non-existent list as default</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='default1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default name='The Empty Set'/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;item-not-found
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p>In order to decline the use of a default list (i.e., to use the domain's stanza routing rules at all times), the user MUST send an empty &lt;default/&gt; element with no 'name' attribute.</p>
    <p class="caption"><a name="example-20" id="example-20"></a>Example 20. Client declines the use of the default list</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='default2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-21" id="example-21"></a>Example 21. Server acknowledges success of declining any default list</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='default2' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p>If one connected resource attempts to decline the use of a default list for the user as a whole but the default list currently applies to at least one other connected resource, the server MUST return a &lt;conflict/&gt; error to the sending resource:</p>
    <p class="caption"><a name="example-22" id="example-22"></a>Example 22. Client attempts to decline a default list but that list is in use by another resource</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='error' id='default3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;default/&gt;
&lt;/query&gt;
&lt;error type='cancel'&gt;
  &lt;conflict
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>2.6 <a name="protocol-edit" id="protocol-edit">Editing a Privacy List</a></h3>
    <p>In order to edit a privacy list, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains one &lt;list/&gt; child element possessing a 'name' attribute whose value is set to the list name the user would like to edit.  The &lt;list/&gt; element MUST contain one or more &lt;item/&gt; elements, which specify the user's desired changes to the list by including all elements in the list (not the "delta").</p>
    <p class="caption"><a name="example-23" id="example-23"></a>Example 23. Client edits a privacy list</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='edit1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='3'/&gt;
    &lt;item type='jid'
          value='paris@example.org'
          action='deny'
          order='5'/&gt;
    &lt;item action='allow' order='68'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-24" id="example-24"></a>Example 24. Server acknowledges success of list edit</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='edit1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p>Note: The value of the 'order' attribute for any given item is not fixed.  Thus in the foregoing example if the user would like to add 4 items between the "tybalt@example.com" item and the "paris@example.org" item, the user's client MUST renumber the relevant items before submitting the list to the server.</p>
    <p>The server MUST now send a "privacy list push" to all connected resources:</p>
    <p class="caption"><a name="example-25" id="example-25"></a>Example 25. Privacy list push on list edit</p><div class="indent"><pre class="prettyprint">
&lt;iq to='romeo@example.net/orchard' type='set' id='push1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;

&lt;iq to='romeo@example.net/home' type='set' id='push2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='public'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>In accordance with the semantics of IQ stanzas defined in <span class="ref"><a href="http://tools.ietf.org/html/rfc6120">XMPP Core</a></span>  [<a href="#nt-idp1647344">7</a>], each connected resource MUST return an IQ result to the server as well:</p>
    <p class="caption"><a name="example-26" id="example-26"></a>Example 26. Acknowledging receipt of privacy list pushes</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard'
  type='result'
  id='push1'/&gt;

&lt;iq from='romeo@example.net/home'
  type='result'
  id='push2'/&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>2.7 <a name="protocol-add" id="protocol-add">Adding a New Privacy List</a></h3>
    <p>The same protocol used to edit an existing list is used to create a new list.  If the list name matches that of an existing list, the request to add a new list will overwrite the old one.  As with list edits, the server MUST also send a "privacy list push" to all connected resources.</p>
  </div>
  <div class="indent"><h3>2.8 <a name="protocol-remove" id="protocol-remove">Removing a Privacy List</a></h3>
    <p>In order to remove a privacy list, the user MUST send an IQ stanza of type "set" with a &lt;query/&gt; element qualified by the 'jabber:iq:privacy' namespace that contains one empty &lt;list/&gt; child element possessing a 'name' attribute whose value is set to the list name the user would like to remove.</p>
    <p class="caption"><a name="example-27" id="example-27"></a>Example 27. Client removes a privacy list</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='remove1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='private'/&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-28" id="example-28"></a>Example 28. Server acknowledges success of list removal</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result' id='remove1' to='romeo@example.net/orchard'/&gt;
    </pre></div>
    <p>If a user attempts to remove a list that is currently being applied to at least one resource other than the sending resource, the server MUST return a &lt;conflict/&gt; stanza error to the user; i.e., the user MUST first set another list to active or default before attempting to remove it.  If the user attempts to remove a list but a list by that name does not exist, the server MUST return an &lt;item-not-found/&gt; stanza error to the user.  If the user attempts to remove more than one list in the same request, the server MUST return a &lt;bad request/&gt; stanza error to the user.</p>
  </div>
  <div class="indent"><h3>2.9 <a name="protocol-message" id="protocol-message">Blocking Messages</a></h3>
    <p>Server-side privacy lists enable a user to block incoming messages from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.  (Note: For the sake of brevity, IQ stanzas of type "result" are not shown in the following examples, nor are "privacy list pushes".)</p>
    <p class="caption"><a name="example-29" id="example-29"></a>Example 29. User blocks based on JID</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='msg1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='3'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive messages from the entity with the specified JID.</p>
    <p class="caption"><a name="example-30" id="example-30"></a>Example 30. User blocks based on roster group</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='msg2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='4'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive messages from any entities in the specified roster group.</p>
    <p class="caption"><a name="example-31" id="example-31"></a>Example 31. User blocks based on subscription type</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='msg3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='5'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive messages from any entities with the specified subscription type.</p>
    <p class="caption"><a name="example-32" id="example-32"></a>Example 32. User blocks globally</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='msg4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='message-global-example'&gt;
    &lt;item action='deny' order='6'&gt;
      &lt;message/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive messages from any other users.</p>
  </div>
  <div class="indent"><h3>2.10 <a name="protocol-presencein" id="protocol-presencein">Blocking Inbound Presence Notifications</a></h3>
    <p>Server-side privacy lists enable a user to block incoming presence notifications from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
  <p>Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to the user because the user is currently subscribed to a contact's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
    <p class="caption"><a name="example-33" id="example-33"></a>Example 33. User blocks based on JID</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presin1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='7'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive presence notifications from the entity with the specified JID.</p>
    <p class="caption"><a name="example-34" id="example-34"></a>Example 34. User blocks based on roster group</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presin2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='8'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive presence notifications from any entities in the specified roster group.</p>
    <p class="caption"><a name="example-35" id="example-35"></a>Example 35. User blocks based on subscription type</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presin3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-sub-example'&gt;
    &lt;item type='subscription'
          value='to'
          action='deny'
          order='9'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive presence notifications from any entities with the specified subscription type.</p>
    <p class="caption"><a name="example-36" id="example-36"></a>Example 36. User blocks globally</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presin4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presin-global-example'&gt;
    &lt;item action='deny' order='11'&gt;
      &lt;presence-in/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive presence notifications from any other users.</p>
    <p>Note: If a client blocks incoming presence notifications from an entity that has been available before, the user's server SHOULD send unavailable presence to the user on behalf of that contact.</p>
  </div>
  <div class="indent"><h3>2.11 <a name="protocol-presenceout" id="protocol-presenceout">Blocking Outbound Presence Notifications</a></h3>
    <p>Server-side privacy lists enable a user to block outgoing presence notifications to other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
  <p>Note: Presence notifications do not include presence subscriptions, only presence information that is broadcasted to contacts because those contacts are currently subscribed to the user's presence information.  Thus this includes presence stanzas with no 'type' attribute or of type='unavailable' only.</p>
    <p class="caption"><a name="example-37" id="example-37"></a>Example 37. User blocks based on JID</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presout1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='13'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not send presence notifications to the entity with the specified JID.</p>
    <p class="caption"><a name="example-38" id="example-38"></a>Example 38. User blocks based on roster group</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presout2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='15'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not send presence notifications to any entities in the specified roster group.</p>
    <p class="caption"><a name="example-39" id="example-39"></a>Example 39. User blocks based on subscription type</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presout3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-sub-example'&gt;
    &lt;item type='subscription'
          value='from'
          action='deny'
          order='17'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not send presence notifications to any entities with the specified subscription type.</p>
    <p class="caption"><a name="example-40" id="example-40"></a>Example 40. User blocks globally</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='presout4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='presout-global-example'&gt;
    &lt;item action='deny' order='23'&gt;
      &lt;presence-out/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not send presence notifications to any other users.</p>
    <p>Note: When a user blocks outbound presence to a contact, the user's server MUST send unavailable presence information to the contact (but only if the contact is allowed to receive presence notifications from the user in accordance with the rules defined in <span class="ref">RFC 6121</span>).</p>
  </div>
  <div class="indent"><h3>2.12 <a name="protocol-iq" id="protocol-iq">Blocking IQ Stanzas</a></h3>
    <p>Server-side privacy lists enable a user to block incoming IQ stanzas from other entities based on the entity's JID, roster group, or subscription status (or globally).  The following examples illustrate the protocol.</p>
    <p class="caption"><a name="example-41" id="example-41"></a>Example 41. User blocks based on JID</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='iq1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='29'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from the entity with the specified JID.</p>
    <p class="caption"><a name="example-42" id="example-42"></a>Example 42. User blocks based on roster group</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='iq2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='31'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any entities in the specified roster group.</p>
    <p class="caption"><a name="example-43" id="example-43"></a>Example 43. User blocks based on subscription type</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='iq3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='17'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any entities with the specified subscription type.</p>
    <p class="caption"><a name="example-44" id="example-44"></a>Example 44. User blocks globally</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='iq4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='iq-global-example'&gt;
    &lt;item action='deny' order='1'&gt;
      &lt;iq/&gt;
    &lt;/item&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive IQ stanzas from any other users.</p>
  </div>
  <div class="indent"><h3>2.13 <a name="protocol-all" id="protocol-all">Blocking All Communication</a></h3>
    <p>Server-side privacy lists enable a user to block all stanzas from and to other entities based on the entity's JID, roster group, or subscription status (or globally).  Note that this includes subscription-related presence stanzas, which are excluded by <a href="#protocol-presencein">Blocking Inbound Presence Notifications</a>.  The following examples illustrate the protocol.</p>
    <p class="caption"><a name="example-45" id="example-45"></a>Example 45. User blocks based on JID</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='all1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-jid-example'&gt;
    &lt;item type='jid'
          value='tybalt@example.com'
          action='deny'
          order='23'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, the entity with the specified JID.</p>
    <p class="caption"><a name="example-46" id="example-46"></a>Example 46. User blocks based on roster group</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='all2'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-group-example'&gt;
    &lt;item type='group'
          value='Enemies'
          action='deny'
          order='13'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any entities in the specified roster group.</p>
    <p class="caption"><a name="example-47" id="example-47"></a>Example 47. User blocks based on subscription type</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='all3'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-sub-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='11'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any entities with the specified subscription type.</p>
    <p class="caption"><a name="example-48" id="example-48"></a>Example 48. User blocks globally</p><div class="indent"><pre class="prettyprint">
&lt;iq from='romeo@example.net/orchard' type='set' id='all4'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='all-global-example'&gt;
    &lt;item action='deny' order='7'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
    <p>As a result of creating and applying the foregoing list, the user will not receive any communications from, nor send any stanzas to, any other users.</p>
  </div>
  <div class="indent"><h3>2.14 <a name="protocol-error" id="protocol-error">Blocked Entity Attempts to Communicate with User</a></h3>
    <p>If a blocked entity attempts to send a stanza to the user (i.e., an inbound stanza from the user's perspective), the user's server shall handle the stanza according to the following rules:</p>
    <ul>
      <li>For presence stanzas (including notifications, subscriptions, and probes), the server MUST NOT respond and MUST NOT return an error.</li>
      <li>For message stanzas, the server SHOULD return an error, which SHOULD be &lt;service-unavailable/&gt;.  [<a href="#nt-idp1699104">8</a>]</li>
      <li>For IQ stanzas of type "get" or "set", the server MUST return an error, which SHOULD be &lt;service-unavailable/&gt;. IQ stanzas of other types MUST be silently dropped by the server.</li>
    </ul>
    <p>If the foregoing suggestions are followed, the user will appear offline to the contact.</p>
    <p class="caption"><a name="example-49" id="example-49"></a>Example 49. Blocked entity attempts to send IQ get</p><div class="indent"><pre class="prettyprint">
&lt;iq type='get'
  to='romeo@example.net'
  from='tybalt@example.com/pda'
  id='probing1'&gt;
&lt;query xmlns='jabber:iq:version'/&gt;
&lt;/iq&gt;
    </pre></div>
    <p class="caption"><a name="example-50" id="example-50"></a>Example 50. Server returns error to blocked entity</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
  from='romeo@example.net'
  to='tybalt@example.com/pda'
  id='probing1'&gt;
&lt;query xmlns='jabber:iq:version'/&gt;
&lt;error type='cancel'&gt;
  &lt;service-unavailable
      xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
&lt;/error&gt;
&lt;/iq&gt;
    </pre></div>
    <p>If the user attempts to send an outbound stanza to a contact and that stanza type is blocked, the user's server MUST NOT route the stanza to the contact but instead MUST return a &lt;not-acceptable/&gt; error:</p>
    <p class="caption"><a name="example-51" id="example-51"></a>Example 51. Error: contact is blocked</p><div class="indent"><pre class="prettyprint">
&lt;message type='error' from='romeo@montague.net' to='juliet@capulet.com'&gt;
  &lt;body&gt;Can you hear me now?&lt;/body&gt;
  &lt;error type='cancel'&gt;
    &lt;not-acceptable xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/message&gt;
    </pre></div>
  </div>
  <div class="indent"><h3>2.15 <a name="protocol-heuristics" id="protocol-heuristics">Higher-Level Heuristics</a></h3>
    <p>When building a representation of a higher-level privacy heuristic, a client SHOULD use the simplest possible representation.</p>
    <p>For example, the heuristic "block all communications with any user not in my roster" could be constructed in any of the following ways:</p>
    <ul>
      <li>allow communications from all JIDs in my roster (i.e., listing each JID as a separate list item), but block communications with everyone else</li>
      <li>allow communications from any user who is in one of the groups that make up my roster (i.e., listing each group as a separate list item), but block communications from everyone else</li>
      <li>allow communications from any user with whom I have a subscription of 'both' or 'to' or 'from' (i.e., listing each subscription value separately), but block communications from everyone else</li>
      <li>block communications from anyone whose subscription state is 'none'</li>
    </ul>
    <p>The final representation is the simplest and SHOULD be used; here is the XML that would be sent in this case:</p>
    <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;iq type='set' id='heuristic1'&gt;
&lt;query xmlns='jabber:iq:privacy'&gt;
  &lt;list name='heuristic-example'&gt;
    &lt;item type='subscription'
          value='none'
          action='deny'
          order='437'/&gt;
  &lt;/list&gt;
&lt;/query&gt;
&lt;/iq&gt;
    </pre></div>
  </div>
<h2>3.
       <a name="disco" id="disco">Discovering Support</a></h2>
  <p>If an entity supports the privacy lists protocol, it MUST report that fact by including a service discovery feature of "jabber:iq:privacy" (see <a href="#ns">Protocol Namespaces</a> regarding issuance of one or more permanent namespaces) in response to a <span class="ref"><a href="http://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idp1714992">9</a>] information request:</p>
  <p class="caption"><a name="example-52" id="example-52"></a>Example 52. Service Discovery information request</p><div class="indent"><pre class="prettyprint">
&lt;iq from='juliet@example.com/chamber'
    id='disco1'
    to='example.com'
    type='get'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
  </pre></div>
  <p class="caption"><a name="example-53" id="example-53"></a>Example 53. Service Discovery information response</p><div class="indent"><pre class="prettyprint">
&lt;iq from='example.com'
    id='disco1'
    to='juliet@example.com/chamber'
    type='result'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='jabber:iq:privacy'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
  </pre></div>
<h2>4.
       <a name="impl" id="impl">Implementation Notes</a></h2>
  <p>When a server receives a block command from a user, it MAY cancel any existing presence subscriptions between the user and the blocked user and MAY send a message to the blocked user; however, it is RECOMMENDED to deploy so-called "polite blocking" instead (i.e., to not cancel the presence subscriptions or send a notification). Which approach to follow is a matter of local service policy.</p>
  <p>A service MAY also filter blocking users out of searches performed on user directories (see, for example, <span class="ref"><a href="http://xmpp.org/extensions/xep-0055.html">Jabber Search (XEP-0055)</a></span>  [<a href="#nt-idp1725232">10</a>]); however, that functionality is out of scope for this specification.</p>
<h2>5.
       <a name="security" id="security">Security Considerations</a></h2>
  <p>If properly implemented, this protocol extension does not introduce any new security concerns above and beyond those defined in <span class="ref">RFC 6120</span> and <span class="ref">RFC 6121</span>.</p>
<h2>6.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p>No interaction with the <span class="ref"><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-idp1727296">11</a>] is required as a result of this specification.</p>
<h2>7.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <div class="indent"><h3>7.1 <a name="registrar-ns" id="registrar-ns">Protocol Namespaces</a></h3>
    <p>The <span class="ref"><a href="http://xmpp.org/registrar/">XMPP Registrar</a></span>  [<a href="#nt-idp1731232">12</a>] already includes 'jabber:iq:privacy' in its registry of protocol namespaces (see &lt;<a href="http://xmpp.org/registrar/namespaces.html">http://xmpp.org/registrar/namespaces.html</a>&gt;).</p>
  </div>
<h2>8.
       <a name="schema" id="schema">XML Schema</a></h2>
  <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema
  xmlns:xs='http://www.w3.org/2001/XMLSchema'
  targetNamespace='jabber:iq:privacy'
  xmlns='jabber:iq:privacy'
  elementFormDefault='qualified'&gt;

  &lt;xs:annotation&gt;
    &lt;xs:documentation&gt;
      The protocol documented by this schema is defined in
      XEP-0016: http://www.xmpp.org/extensions/xep-0016.html
    &lt;/xs:documentation&gt;
  &lt;/xs:annotation&gt;

&lt;xs:element name='query'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref='active'
                  minOccurs='0'/&gt;
      &lt;xs:element ref='default'
                  minOccurs='0'/&gt;
      &lt;xs:element ref='list'
                  minOccurs='0'
                  maxOccurs='unbounded'/&gt;
    &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='active'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base='xs:NMTOKEN'&gt;
        &lt;xs:attribute name='name'
                      type='xs:string'
                      use='optional'/&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='default'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:simpleContent&gt;
      &lt;xs:extension base='xs:NMTOKEN'&gt;
        &lt;xs:attribute name='name'
                      type='xs:string'
                      use='optional'/&gt;
      &lt;/xs:extension&gt;
    &lt;/xs:simpleContent&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='list'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element ref='item'
                  minOccurs='0'
                  maxOccurs='unbounded'/&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name='name'
                  type='xs:string'
                  use='required'/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:element name='item'&gt;
  &lt;xs:complexType&gt;
    &lt;xs:sequence&gt;
      &lt;xs:element name='iq'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='message'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='presence-in'
                  minOccurs='0'
                  type='empty'/&gt;
      &lt;xs:element name='presence-out'
                  minOccurs='0'
                  type='empty'/&gt;
    &lt;/xs:sequence&gt;
    &lt;xs:attribute name='action' use='required'&gt;
      &lt;xs:simpleType&gt;
        &lt;xs:restriction base='xs:NCName'&gt;
          &lt;xs:enumeration value='allow'/&gt;
          &lt;xs:enumeration value='deny'/&gt;
        &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
    &lt;/xs:attribute&gt;
    &lt;xs:attribute name='order'
                  type='xs:unsignedInt'
                  use='required'/&gt;
    &lt;xs:attribute name='type' use='optional'&gt;
      &lt;xs:simpleType&gt;
        &lt;xs:restriction base='xs:NCName'&gt;
          &lt;xs:enumeration value='group'/&gt;
          &lt;xs:enumeration value='jid'/&gt;
          &lt;xs:enumeration value='subscription'/&gt;
        &lt;/xs:restriction&gt;
      &lt;/xs:simpleType&gt;
    &lt;/xs:attribute&gt;
    &lt;xs:attribute name='value'
                  type='xs:string'
                  use='optional'/&gt;
  &lt;/xs:complexType&gt;
&lt;/xs:element&gt;

&lt;xs:simpleType name='empty'&gt;
  &lt;xs:restriction base='xs:string'&gt;
    &lt;xs:enumeration value=''/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;/xs:schema&gt;
  </pre></div>
<h2>9.
       <a name="authornote" id="authornote">Author Note</a></h2>
<p>Peter Millard, the author of this specification from version 0.1 through version 0.3, died on April 26, 2006.</p>
<hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0016<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status: 
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Draft">Draft</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 1.6<br />
            Last Updated: 2007-02-15<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: privacy<br />
              Source Control: 
                <a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0016.xml">HTML</a><br />
            This document in other formats: 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0016.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0016.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Peter Millard</h3><p class="indent">
        See <a href="#authornote">Author Note</a><br /></p><h3>Peter Saint-Andre</h3><p class="indent">
        Email:
        <a href="mailto:peter@andyet.net">peter@andyet.net</a><br />
        JabberID: 
        <a href="xmpp:stpeter@stpeter.im">stpeter@stpeter.im</a><br />
        URI: 
        <a href="https://stpeter.im/">https://stpeter.im/</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 - 2014 by the <a href="http://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/">http://xmpp.org/about-xmpp/xsf/xsf-ipr-policy/</a>&gt; or obtained by writing to XMPP Standards Foundation, 1899 Wynkoop Street, Suite 600, Denver, CO 80202 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-idp706864" id="nt-idp706864">1</a>. XEP-0191: Blocking Command &lt;<a href="http://xmpp.org/extensions/xep-0191.html">http://xmpp.org/extensions/xep-0191.html</a>&gt;.</p><p><a name="nt-idp1559216" id="nt-idp1559216">2</a>. RFC 3921: Extensible Messaging and Presence Protocol (XMPP): Instant Messaging and Presence &lt;<a href="http://tools.ietf.org/html/rfc3921">http://tools.ietf.org/html/rfc3921</a>&gt;.</p><p><a name="nt-idp1562528" id="nt-idp1562528">3</a>. RFC 2779: A Model for Presence and Instant Messaging &lt;<a href="http://tools.ietf.org/html/rfc2779">http://tools.ietf.org/html/rfc2779</a>&gt;.</p><p><a name="nt-idp1576960" id="nt-idp1576960">4</a>. An implementation MUST NOT block communications from one of a user's resources to another, even if the user happens to define a rule that would otherwise result in that behavior.</p><p><a name="nt-idp1581520" id="nt-idp1581520">5</a>. When a &lt;presence-out/&gt; element is included, the server might want to also block presence-like notifications, such as those which use <span class="ref"><a href="http://xmpp.org/extensions/xep-0163.html">Personal Eventing Protocol (XEP-0163)</a></span>  [<a href="#nt-idp1584544">6</a>].</p><p><a name="nt-idp1584544" id="nt-idp1584544">6</a>. XEP-0163: Personal Eventing Protocol &lt;<a href="http://xmpp.org/extensions/xep-0163.html">http://xmpp.org/extensions/xep-0163.html</a>&gt;.</p><p><a name="nt-idp1647344" id="nt-idp1647344">7</a>. RFC 6120: Extensible Messaging and Presence Protocol (XMPP): Core &lt;<a href="http://tools.ietf.org/html/rfc6120">http://tools.ietf.org/html/rfc6120</a>&gt;.</p><p><a name="nt-idp1699104" id="nt-idp1699104">8</a>. Until version 1.5 of this document (therefore also in <span class="ref">RFC 6121</span>), it was recommended to silently ignore message stanzas, which unfortunately resulted in a delivery "black hole" regarding message stanzas.</p><p><a name="nt-idp1714992" id="nt-idp1714992">9</a>. XEP-0030: Service Discovery &lt;<a href="http://xmpp.org/extensions/xep-0030.html">http://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-idp1725232" id="nt-idp1725232">10</a>. XEP-0055: Jabber Search &lt;<a href="http://xmpp.org/extensions/xep-0055.html">http://xmpp.org/extensions/xep-0055.html</a>&gt;.</p><p><a name="nt-idp1727296" id="nt-idp1727296">11</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p><p><a name="nt-idp1731232" id="nt-idp1731232">12</a>. The XMPP Registrar maintains a list of reserved protocol namespaces as well as registries of parameters used in the context of XMPP extension protocols approved by the XMPP Standards Foundation. For further information, see &lt;<a href="http://xmpp.org/registrar/">http://xmpp.org/registrar/</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 1.6 (2007-02-15)</h4><div class="indent"><p>Added two notes to maintain consistency with XEP-0191.</p> (psa)
    </div><h4>Version 1.5 (2006-11-27)</h4><div class="indent"><p>Modified message stanza handling (server should return &lt;service-unavailable/&gt; error) and added implementation note to maintain consistency with XEP-0191.</p> (psa)
    </div><h4>Version 1.4 (2006-10-04)</h4><div class="indent"><p>Copied Section 10 of RFC 3921.</p> (psa)
    </div><h4>Version 1.3 (2004-07-26)</h4><div class="indent"><p>Formally retracted this proposal in favor of XMPP IM.</p> (psa)
    </div><h4>Version 1.2 (2003-03-12)</h4><div class="indent"><p>Changed status to Deprecated since this protocol is now included in the XMPP IM Internet-Draft.</p> (psa)
    </div><h4>Version 1.1 (2002-11-17)</h4><div class="indent"><p>Added remarks about default handling, and where list processing should take place.</p> (pgm)
    </div><h4>Version 1.0 (2002-10-22)</h4><div class="indent"><p>Changed status to Draft.</p> (psa)
    </div><h4>Version 0.4 (2002-10-03)</h4><div class="indent"><p>Elaborated on various JID possibilities.</p> (pgm)
    </div><h4>Version 0.3 (2002-07-31)</h4><div class="indent"><p>Added info describing current session issues</p> (pgm)
    </div><h4>Version 0.2 (2002-07-30)</h4><div class="indent"><p>Added whitelists, subscription filtering, and multiple list capabilities. Changed block to deny.</p> (pgm)
    </div><h4>Version 0.1 (2002-01-18)</h4><div class="indent"><p>Initial version.</p> (pgm)
    </div></div><hr /><p>END</p></body></html>
